# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# AddFieldsforMyGov.py
# Created on: 2014-09-30 17:06:37.00000 by Lee Allen
#   (generated by ArcGIS/ModelBuilder)
# Description: This script goes through several joins, spatial joins, prints status to a log file, and on the screen. Needs cleanup in the overwrite gp. Also need to add an email function. Is fairly rough, and needs some cleanup. 
# ---------------------------------------------------------------------------

# Import arcpy module
import arcpy
import arcgisscripting
import datetime
import time
import sys
gp = arcgisscripting.create()
gp.overwriteoutput = 1


# Local variables:
f = open("\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\UpdatedFiles\\log.txt","w")
##sys.stdout = open("\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\UpdatedFiles\\log.txt","w")
SDE_Dynamic_GISADMIN_Parcels = "\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\SDE_Dynamic@gisviewer.sde\\SDE_Dynamic.GISADMIN.Parcels"
SDE_Dynamic_GISADMIN_Council = "\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\SDE_Dynamic@gisviewer.sde\\SDE_Dynamic.GISADMIN.Council"
NIAs_shp = "\\\\cot_gis\\vol1\\Shapefiles\\Metro\\NIAs.shp"
NAs_shp = "\\\\cot_gis\\vol1\\Shapefiles\\Metro\\NAs.shp"
CodeOfficerArea = "\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\CodeOfficerArea"
LocationTable_dbf = "\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\LocationTable.dbf"
UpdatedFiles = "\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\UpdatedFiles"
ParcelsTerr = "\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr"
ParcelsTerrCounc = "\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc"
ParcelsTerrCouncNia = "\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia"
LocationRecordsOL = "\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA"
ParcelsTerrCouncNiaNA_Layer = "ParcelsTerrCouncNiaNA_Layer"
LocationTableCounty = "LocationTableCounty"
ParcelsTerrCouncNiaNA = "\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA"
ParcelsTerrCouncNiaNAJoin = "ParcelsTerrCouncNiaNA_Layer"


print "Beginning Process"
f.write("Beginning Process" + "\n")
# Process: Join Code Areas
arcpy.SpatialJoin_analysis(SDE_Dynamic_GISADMIN_Parcels, CodeOfficerArea, ParcelsTerr, "JOIN_ONE_TO_MANY", "KEEP_ALL", "", "HAVE_THEIR_CENTER_IN", "", "")
print "Completed Step 1"
f.write("Completed Step 1" + "\n")


print "Joining Council Districts- Step 2"
f.write("Joining Council Districts- Step 2" + "\n")
# Process: Join Council Districts
arcpy.SpatialJoin_analysis(ParcelsTerr, SDE_Dynamic_GISADMIN_Council, ParcelsTerrCounc, "JOIN_ONE_TO_MANY", "KEEP_ALL", "PARCELNUM \"PARCELNUM\" true true false 6 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,PARCELNUM,-1,-1;ACRES \"ACRES\" true true false 8 Double 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,ACRES,-1,-1;PIN \"PIN\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,PIN,-1,-1;PID \"PID\" true true false 16 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,PID,-1,-1;QUICKREFID \"QUICKREFID\" true true false 10 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,QUICKREFID,-1,-1;ONAME \"ONAME\" true true false 100 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,ONAME,-1,-1;PADDRESS \"PADDRESS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,PADDRESS,-1,-1;PADDRESS2 \"PADDRESS2\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,PADDRESS2,-1,-1;MAILNAME \"MAILNAME\" true true false 100 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,MAILNAME,-1,-1;MAILADDRESS \"MAILADDRESS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,MAILADDRESS,-1,-1;MAILADDRESS2 \"MAILADDRESS2\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,MAILADDRESS2,-1,-1;DBOOKPAGE \"DBOOKPAGE\" true true false 15 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,DBOOKPAGE,-1,-1;SUBS \"SUBS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,SUBS,-1,-1;NBHD \"NBHD\" true true false 5 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,NBHD,-1,-1;TAXUNIT \"TAXUNIT\" true true false 3 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,TAXUNIT,-1,-1;USD \"USD\" true true false 15 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,USD,-1,-1;LBCSFUNCTION \"LBCSFUNCTION\" true true false 255 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,LBCSFUNCTION,-1,-1;LBCSACTIVITY \"LBCSACTIVITY\" true true false 255 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,LBCSACTIVITY,-1,-1;CLASS \"CLASS\" true true false 1 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,CLASS,-1,-1;BLDGVAL \"BLDGVAL\" true true false 4 Long 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,BLDGVAL,-1,-1;LDVAL \"LDVAL\" true true false 4 Long 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,LDVAL,-1,-1;TOTVAL \"TOTVAL\" true true false 4 Long 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,TOTVAL,-1,-1;Location \"Location\" true true false 80 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,Location,-1,-1;Code_Officer_Name \"Code_Officer_Name\" true true false 25 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,Code_Officer_Name,-1,-1;Code_Officer_Radio_Number \"Code_Officer_Radio_Number\" true true false 5 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,Code_Officer_Radio_Number,-1,-1;Code_Officer_Phone_Number \"Code_Officer_Phone_Number\" true true false 10 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,Code_Officer_Phone_Number,-1,-1;Code_Officer_Email \"Code_Officer_Email\" true true false 25 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerr,Code_Officer_Email,-1,-1;District \"District\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\SDE_Dynamic@gisviewer.sde\\SDE_Dynamic.GISADMIN.Council,District,-1,-1", "HAVE_THEIR_CENTER_IN", "", "")
print "Completed Step 2"
f.write("Completed Step 2" + "\n")

print "Joining NIAs - Step 3"
f.write("Joining NIAs - Step 3" + "\n")
# Process: Join NIAs
arcpy.SpatialJoin_analysis(ParcelsTerrCounc, NIAs_shp, ParcelsTerrCouncNia, "JOIN_ONE_TO_MANY", "KEEP_ALL", "PARCELNUM \"PARCELNUM\" true true false 6 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,PARCELNUM,-1,-1;ACRES \"ACRES\" true true false 8 Double 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,ACRES,-1,-1;PIN \"PIN\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,PIN,-1,-1;PID \"PID\" true true false 16 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,PID,-1,-1;QUICKREFID \"QUICKREFID\" true true false 10 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,QUICKREFID,-1,-1;ONAME \"ONAME\" true true false 100 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,ONAME,-1,-1;PADDRESS \"PADDRESS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,PADDRESS,-1,-1;PADDRESS2 \"PADDRESS2\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,PADDRESS2,-1,-1;MAILNAME \"MAILNAME\" true true false 100 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,MAILNAME,-1,-1;MAILADDRESS \"MAILADDRESS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,MAILADDRESS,-1,-1;MAILADDRESS2 \"MAILADDRESS2\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,MAILADDRESS2,-1,-1;DBOOKPAGE \"DBOOKPAGE\" true true false 15 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,DBOOKPAGE,-1,-1;SUBS \"SUBS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,SUBS,-1,-1;NBHD \"NBHD\" true true false 5 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,NBHD,-1,-1;TAXUNIT \"TAXUNIT\" true true false 3 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,TAXUNIT,-1,-1;USD \"USD\" true true false 15 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,USD,-1,-1;LBCSFUNCTION \"LBCSFUNCTION\" true true false 255 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,LBCSFUNCTION,-1,-1;LBCSACTIVITY \"LBCSACTIVITY\" true true false 255 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,LBCSACTIVITY,-1,-1;CLASS \"CLASS\" true true false 1 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,CLASS,-1,-1;BLDGVAL \"BLDGVAL\" true true false 4 Long 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,BLDGVAL,-1,-1;LDVAL \"LDVAL\" true true false 4 Long 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,LDVAL,-1,-1;TOTVAL \"TOTVAL\" true true false 4 Long 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,TOTVAL,-1,-1;Location \"Location\" true true false 80 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,Location,-1,-1;Code_Officer_Name \"Code_Officer_Name\" true true false 25 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,Code_Officer_Name,-1,-1;Code_Officer_Radio_Number \"Code_Officer_Radio_Number\" true true false 5 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,Code_Officer_Radio_Number,-1,-1;Code_Officer_Phone_Number \"Code_Officer_Phone_Number\" true true false 10 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,Code_Officer_Phone_Number,-1,-1;Code_Officer_Email \"Code_Officer_Email\" true true false 25 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,Code_Officer_Email,-1,-1;District \"District\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCounc,District,-1,-1;NIA__NAME \"NIA__NAME\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Shapefiles\\Metro\\NIAs.shp,NIA__NAME,-1,-1;NIA_NA \"NIA_NA\" true true false 5 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Shapefiles\\Metro\\NIAs.shp,NIA_NA,-1,-1;Number \"Number\" true true false 4 Short 0 4 ,First,#,\\\\cot_gis\\vol1\\Shapefiles\\Metro\\NIAs.shp,Number,-1,-1", "HAVE_THEIR_CENTER_IN", "", "")
print "Completed Step 3"
f.write("Completed Step 3" + "\n")

print "Joining NAs - Step 4"
f.write("Completed Step 1" + "\n")
# Process: Join NAs
arcpy.SpatialJoin_analysis(ParcelsTerrCouncNia, NAs_shp, LocationRecordsOL, "JOIN_ONE_TO_MANY", "KEEP_ALL", "PARCELNUM \"PARCELNUM\" true true false 6 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,PARCELNUM,-1,-1;ACRES \"ACRES\" true true false 8 Double 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,ACRES,-1,-1;PIN \"PIN\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,PIN,-1,-1;PID \"PID\" true true false 16 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,PID,-1,-1;QUICKREFID \"QUICKREFID\" true true false 10 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,QUICKREFID,-1,-1;ONAME \"ONAME\" true true false 100 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,ONAME,-1,-1;PADDRESS \"PADDRESS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,PADDRESS,-1,-1;PADDRESS2 \"PADDRESS2\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,PADDRESS2,-1,-1;MAILNAME \"MAILNAME\" true true false 100 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,MAILNAME,-1,-1;MAILADDRESS \"MAILADDRESS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,MAILADDRESS,-1,-1;MAILADDRESS2 \"MAILADDRESS2\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,MAILADDRESS2,-1,-1;DBOOKPAGE \"DBOOKPAGE\" true true false 15 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,DBOOKPAGE,-1,-1;SUBS \"SUBS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,SUBS,-1,-1;NBHD \"NBHD\" true true false 5 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,NBHD,-1,-1;TAXUNIT \"TAXUNIT\" true true false 3 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,TAXUNIT,-1,-1;USD \"USD\" true true false 15 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,USD,-1,-1;LBCSFUNCTION \"LBCSFUNCTION\" true true false 255 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,LBCSFUNCTION,-1,-1;LBCSACTIVITY \"LBCSACTIVITY\" true true false 255 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,LBCSACTIVITY,-1,-1;CLASS \"CLASS\" true true false 1 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,CLASS,-1,-1;BLDGVAL \"BLDGVAL\" true true false 4 Long 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,BLDGVAL,-1,-1;LDVAL \"LDVAL\" true true false 4 Long 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,LDVAL,-1,-1;TOTVAL \"TOTVAL\" true true false 4 Long 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,TOTVAL,-1,-1;Location \"Location\" true true false 80 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,Location,-1,-1;Code_Officer_Name \"Code_Officer_Name\" true true false 25 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,Code_Officer_Name,-1,-1;Code_Officer_Radio_Number \"Code_Officer_Radio_Number\" true true false 5 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,Code_Officer_Radio_Number,-1,-1;Code_Officer_Phone_Number \"Code_Officer_Phone_Number\" true true false 10 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,Code_Officer_Phone_Number,-1,-1;Code_Officer_Email \"Code_Officer_Email\" true true false 25 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,Code_Officer_Email,-1,-1;District \"District\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,District,-1,-1;NIA__NAME \"NIA__NAME\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,NIA__NAME,-1,-1;NIA_NA \"NIA_NA\" true true false 5 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,NIA_NA,-1,-1;Number \"Number\" true true false 4 Short 0 4 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNia,Number,-1,-1;NA_Name \"NA_Name\" true true false 25 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Shapefiles\\Metro\\NAs.shp,NA_Name,-1,-1;NA_Number \"NA_Number\" true true false 4 Short 0 4 ,First,#,\\\\cot_gis\\vol1\\Shapefiles\\Metro\\NAs.shp,NA_Number,-1,-1", "HAVE_THEIR_CENTER_IN", "", "")
print "Completed Step 4"
f.write("Joining NAs - Step 4" + "\n")

print "Indexing - Step 5"
f.write("Indexing - Step 5" + "\n")
# Process: Add Attribute Index
arcpy.AddIndex_management(LocationRecordsOL, "PIN;PID;QUICKREFID", "JoinIndex", "UNIQUE", "NON_ASCENDING")
print "Completed Step 5"
f.write("Completed Step 5" + "\n")


# Process: Make Feature Layer
arcpy.MakeFeatureLayer_management(ParcelsTerrCouncNiaNA, ParcelsTerrCouncNiaNA_Layer, "", "", "OBJECTID OBJECTID VISIBLE NONE;Shape Shape VISIBLE NONE;Join_Count Join_Count VISIBLE NONE;TARGET_FID TARGET_FID VISIBLE NONE;JOIN_FID JOIN_FID VISIBLE NONE;PARCELNUM PARCELNUM VISIBLE NONE;ACRES ACRES VISIBLE NONE;PIN PIN VISIBLE NONE;PID PID VISIBLE NONE;QUICKREFID QUICKREFID VISIBLE NONE;ONAME ONAME VISIBLE NONE;PADDRESS PADDRESS VISIBLE NONE;PADDRESS2 PADDRESS2 VISIBLE NONE;MAILNAME MAILNAME VISIBLE NONE;MAILADDRESS MAILADDRESS VISIBLE NONE;MAILADDRESS2 MAILADDRESS2 VISIBLE NONE;DBOOKPAGE DBOOKPAGE VISIBLE NONE;SUBS SUBS VISIBLE NONE;NBHD NBHD VISIBLE NONE;TAXUNIT TAXUNIT VISIBLE NONE;USD USD VISIBLE NONE;LBCSFUNCTION LBCSFUNCTION VISIBLE NONE;LBCSACTIVITY LBCSACTIVITY VISIBLE NONE;CLASS CLASS VISIBLE NONE;BLDGVAL BLDGVAL VISIBLE NONE;LDVAL LDVAL VISIBLE NONE;TOTVAL TOTVAL VISIBLE NONE;Location Location VISIBLE NONE;Code_Officer_Name Code_Officer_Name VISIBLE NONE;Code_Officer_Radio_Number Code_Officer_Radio_Number VISIBLE NONE;Code_Officer_Phone_Number Code_Officer_Phone_Number VISIBLE NONE;Code_Officer_Email Code_Officer_Email VISIBLE NONE;District District VISIBLE NONE;NIA__NAME NIA__NAME VISIBLE NONE;NIA_NA NIA_NA VISIBLE NONE;Number Number VISIBLE NONE;NA_Name NA_Name VISIBLE NONE;NA_Number NA_Number VISIBLE NONE")


# Process: Make Table View
arcpy.MakeTableView_management(LocationTable_dbf, LocationTableCounty, "", "", "OID OID HIDDEN NONE;QuickRefID QuickRefID VISIBLE NONE;PIN PIN VISIBLE NONE;SubLot SubLot VISIBLE NONE;SubLotRang SubLotRang VISIBLE NONE;StreetNumb StreetNumb VISIBLE NONE;UnitNumber UnitNumber VISIBLE NONE;StreetDire StreetDire VISIBLE NONE;StreetName StreetName VISIBLE NONE;StreetSuff StreetSuff VISIBLE NONE;City City VISIBLE NONE;State State VISIBLE NONE;Zip Zip VISIBLE NONE;PUC_Owner PUC_Owner VISIBLE NONE;PUC_ADDRES PUC_ADDRES VISIBLE NONE;PUC_ADDR_1 PUC_ADDR_1 VISIBLE NONE;AdHocTaxYe AdHocTaxYe VISIBLE NONE;PropertyAd PropertyAd VISIBLE NONE;OwnerName OwnerName VISIBLE NONE;OwnerAddre OwnerAddre VISIBLE NONE")


# Process: Add Join
arcpy.AddJoin_management(ParcelsTerrCouncNiaNA_Layer, "QUICKREFID", LocationTableCounty, "QuickRefID", "KEEP_ALL")

print "Writing  -J:-Code Sevices-MyGovFiles-UpdatedFiles-LocationRecords"
f.write("Writing  -J:-Code Sevices-MyGovFiles-UpdatedFiles-LocationRecords" + "\n")
print "This should take about 32 minutes to finish"
f.write("This should take about 32 minutes to finish" + "\n")
print "Current date and time:"
f.write("Current date and time:" + "\n")
print (time.strftime("%Y-%m-%d %H:%M"))
f.write(time.strftime("%Y-%m-%d %H:%M"))
f.write("\n")

# Process: Table to Table
arcpy.TableToTable_conversion(ParcelsTerrCouncNiaNAJoin, UpdatedFiles, "LocationRecords.dbf", "", "ACRES \"ACRES\" true true false 8 Double 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.ACRES,-1,-1;PID \"PID\" true true false 16 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.PID,-1,-1;QUICKREFID \"QUICKREFID\" true true false 10 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.QUICKREFID,-1,-1;owner_name \"ONAME\" true true false 100 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.ONAME,-1,-1;PAddress \"PADDRESS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.PADDRESS,-1,-1;PAddress2 \"PADDRESS2\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.PADDRESS2,-1,-1;MAILNAME \"MAILNAME\" true true false 100 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.MAILNAME,-1,-1;MAILADDRES \"MAILADDRESS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.MAILADDRESS,-1,-1;MAILADDRES2 \"MAILADDRESS2\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.MAILADDRESS2,-1,-1;DBOOKPAGE \"DBOOKPAGE\" true true false 15 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.DBOOKPAGE,-1,-1;SUBS \"SUBS\" true true false 50 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.SUBS,-1,-1;LBCSFUNCTI \"LBCSFUNCTION\" true true false 255 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.LBCSFUNCTION,-1,-1;LBCSACTIVI \"LBCSACTIVITY\" true true false 255 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.LBCSACTIVITY,-1,-1;CLASS \"CLASS\" true true false 1 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.CLASS,-1,-1;Inspector_Area \"Code_Officer_Name\" true true false 25 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.Code_Officer_Name,-1,-1;CouncilDistrict \"District\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.District,-1,-1;NIA__NAME \"NIA__NAME\" true true false 30 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.NIA__NAME,-1,-1;NA_Name \"NA_Name\" true true false 25 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,ParcelsTerrCouncNiaNA.NA_Name,-1,-1;legal_lot \"legal_lot\" true false false 100 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.SubLot,-1,-1;address_number \"address_number\" true false false 20 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.StreetNumb,-1,-1;address_bldg_number \"address_bldg_number\" true false false 20 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.UnitNumber,-1,-1;address_direction \"address_direction\" true false false 5 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.StreetDire,-1,-1;address_street \"address_street\" true false false 64 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.StreetName,-1,-1;address_type \"address_type\" true false false 5 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.StreetSuff,-1,-1;address_city \"address_city\" true false false 40 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.City,-1,-1;address_state \"address_state\" true false false 2 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.State,-1,-1;address_zip \"address_zip\" true false false 10 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.Zip,-1,-1;PUC_Owner \"PUC_Owner\" true false false 167 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.PUC_Owner,-1,-1;PUC_Address \"PUC_Address\" true false false 254 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.PUC_ADDRES,-1,-1;PUC_Address2 \"PUC_Address2\" true false false 54 Text 0 0 ,First,#,\\\\cot_gis\\vol1\\Code Sevices\\MyGovFiles\\DataToExportToUpdatedFiles.gdb\\ParcelsTerrCouncNiaNA,LocationTable.PUC_ADDR_1,-1,-1", "")

print "Process Complete, Have a nice day!"
f.write("Process Complete, Have a nice day!" + "\n")
print (time.strftime("%Y-%m-%d %H:%M"))
f.write(time.strftime("%Y-%m-%d %H:%M"))
f.write("\n")
f.close()


